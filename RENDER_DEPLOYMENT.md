# Render Deployment Guide

This guide explains how to deploy StudyConnect AI on Render with React frontend, Python backend, and PostgreSQL database.

## Architecture

- **Frontend**: React + TypeScript (built to static files)
- **Backend**: Flask (Python) serving API and static files
- **Database**: PostgreSQL (Render Free Tier)

## Automatic Deployment with render.yaml

This project includes a `render.yaml` file for automatic deployment:

1. **Push to GitHub**: Make sure your code is pushed to a GitHub repository
2. **Connect to Render**: 
   - Go to https://dashboard.render.com
   - Click "New" → "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml` and create:
     - A web service (studyconnect-ai)
     - A PostgreSQL database (studyconnect-db)

## Manual Deployment Steps

If you prefer manual setup:

### 1. Create PostgreSQL Database

1. In Render Dashboard, click "New" → "PostgreSQL"
2. Name: `studyconnect-db`
3. Database: `studyconnect`
4. User: `studyconnect`
5. Region: `Oregon (US West)` (or your preferred region)
6. Plan: `Free`
7. Click "Create Database"

### 2. Create Web Service

1. In Render Dashboard, click "New" → "Web Service"
2. Connect your GitHub repository
3. Configure:
   - **Name**: `studyconnect-ai`
   - **Region**: Same as database
   - **Branch**: `main`
   - **Root Directory**: Leave empty
   - **Environment**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt && npm install && npm run build`
   - **Start Command**: `gunicorn app:app`
   - **Plan**: `Free`

4. Add Environment Variables:
   - `DATABASE_URL`: Select your PostgreSQL database from the dropdown
   - `SECRET_KEY`: Generate a random secret key
   - `FLASK_ENV`: `production`
   - `PYTHON_VERSION`: `3.11.0`

5. Click "Create Web Service"

## Environment Variables

- `DATABASE_URL`: Automatically set when you link the database
- `SECRET_KEY`: Used for Flask session management (auto-generated by Render)
- `FLASK_ENV`: Set to `production` for deployment
- `PORT`: Automatically set by Render (defaults to 5000)

## Local Development

### Prerequisites

- Python 3.11+
- Node.js 18+
- PostgreSQL (or use a local SQLite for testing)

### Setup

1. Clone the repository:
   ```bash
   git clone <your-repo-url>
   cd StudyConnectAIA
   ```

2. Install Python dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Install Node.js dependencies:
   ```bash
   npm install
   ```

4. Set environment variables:
   ```bash
   export DATABASE_URL=postgresql://localhost/studyconnect
   export SECRET_KEY=your-dev-secret-key
   export FLASK_ENV=development
   ```

5. Build the frontend:
   ```bash
   npm run build
   ```

6. Run the development server:
   ```bash
   python app.py
   ```

7. Open http://localhost:5000

## Database Migrations

The application automatically creates tables on startup using SQLAlchemy's `db.create_all()`.

For production, consider using Flask-Migrate:
```bash
pip install Flask-Migrate
```

## Troubleshooting

### Build Failures

- **Python version**: Ensure `runtime.txt` specifies Python 3.11.0
- **Dependencies**: Check `requirements.txt` for any missing packages
- **Frontend build**: Ensure `npm run build` completes successfully

### Database Connection Issues

- Verify `DATABASE_URL` environment variable is set correctly
- Ensure the database is in the same region as the web service
- Check that the database is not suspended (free tier limitations)

### Static Files Not Loading

- Verify `dist/public` directory exists after build
- Check Flask static folder configuration in `app.py`
- Ensure build command includes `npm run build`

## Monitoring

- **Logs**: View logs in Render Dashboard → Your Service → Logs
- **Database**: Monitor in Render Dashboard → Your Database → Metrics
- **Health Check**: Visit `/api/health` endpoint

## Scaling

The free tier includes:
- 750 hours/month for web service
- 1GB RAM
- Free PostgreSQL with 256MB RAM

For production workloads, upgrade to paid plans:
- **Starter Plan**: $7/month for web service
- **Standard Plan**: $7/month for PostgreSQL (1GB RAM)

## Security Notes

- Change `SECRET_KEY` in production
- Implement password hashing (use bcrypt or Argon2)
- Enable HTTPS (automatic on Render)
- Add rate limiting for API endpoints
- Implement proper authentication/authorization

## Support

For issues:
- Check Render documentation: https://render.com/docs
- Review Flask documentation: https://flask.palletsprojects.com/
- Open an issue in the GitHub repository

